<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_advice_sheet">
        <!-- Use basic_layout instead of external_layout to remove top white space -->
        <t t-call="web.basic_layout">
            <main class="page" style="margin: 0; padding: 0;">

                <t t-foreach="docs" t-as="doc">

                    <!-- Header Section -->
                    <div class="d-flex justify-content-start align-items-center text-center"
                         style="color: green; width:100%; margin-top: 0; padding-top: 0;">
                        <img
                                t-att-src="'/dsl_hms_physiotherapy_extension/static/img/sahic.png'"
                                alt="Hospital Logo"
                                style="width: 200px; height: 200px; margin-right:20px;"
                        />
                        <div>
                            <div style="font-size:25px; font-weight:700; margin-top:3px;">
                                সোসাইটি ফর এসিস্ট্যান্স টু হিয়ারিং ইম্পেয়ার্ড চিলড্রেন (সাহিক)
                                <br/>
                                স্পীচ থেরাপী বিভাগ
                                <br/>
                            </div>
                            <div style="font-size: 20px; margin-top: 3px;">
                                মহাখালী, ঢাকা-১২১২
                            </div>
                            <div style="font-size: 20px; margin-top: 3px;">
                                ফোন: ০২২২২২৮২০০৭, ০২২২২২৮১৫৩৫, ০২২২২২৮৬৫৩৭ এক্স-১২৮
                            </div>
                            <div style="font-size: 20px;margin-top: 3px;">
                                মোবাইল: ০১৭৬৬৮০৫৮৮৬, ০১৭৯৮৭২২৪৬৪
                            </div>
                            <div style="font-size: 20px;margin-top: 5px;">
                                সময়: সকাল ৮টা - দুপুর ২.৩০ টা
                            </div>
                        </div>
                    </div>

                    <hr style="margin-top:20px; margin-bottom:20px; border: 1px solid #000;"/>

                    <!-- Patient Information -->
                    <div style="font-size: 16px;">
                        <table style="width:100%; border-collapse: collapse;">
                            <tr>
                                <td style="width:33%;">
                                    <strong>রোগীর নাম:</strong>
                                    <t t-if="doc.patient_id">
                                        <span t-field="doc.patient_id.name"/>
                                    </t>
                                    <t t-else="">N/A</t>
                                </td>
                                <td style="width:33%;">
                                    <strong>রেজি নং:</strong>
                                    <span t-field="doc.code"/>
                                </td>
                                <td style="width:33%;">
                                    <strong>তারিখ:</strong>
                                    <span t-esc="datetime.date.today().strftime('%d-%m-%Y')"/>
                                </td>
                            </tr>
                        </table>
                    </div>

                    <hr style="margin-top:20px; margin-bottom:20px; border: 1px solid #000;"/>

                    <!-- Advice Section -->
                    <div style="margin-top: 15px;">
                        <p style="color:#333; margin-bottom:10px; font-size:25px;">উপদেশ:</p>

                        <!-- If advice exists, show bullet-point list -->
                        <t t-if="doc.advice_ids">
                            <ul style="list-style-type: disc; margin: 10px 5px 0 0; padding-left: 20px; color: #333;">
                                <t t-foreach="doc.advice_ids" t-as="advice">
                                    <li style="margin-bottom: 10px; font-size: 20px;">
                                        <span t-field="advice.name"/>
                                    </li>
                                </t>
                            </ul>
                        </t>

                        <!-- Else show "no advice" message -->
                        <t t-else="">
                            <p style="color: #999; font-style: italic; margin-top: 8px;">
                                No advice selected for this session.
                            </p>
                        </t>
                    </div>

                    <!-- Footer with Signature -->
                    <div style="margin-top:50px; width:100%; display:flex; justify-content:flex-end;">
                        <div style="text-align:left;">
                            <t t-if="doc.physiotherapist_id and doc.physiotherapist_id.signature">
                                <div style="display:flex; flex-direction:column-reverse; align-items:flex-start;">
                                    <!-- Signature line -->
                                    <div style="border-top:1px solid #000; width:220px; margin-top:50px;"></div>

                                    <!-- Signature image -->
                                    <img t-att-src="'data:image/png;base64,%s' % doc.physiotherapist_id.signature.decode('utf-8')"
                                         style="width:200px; height:auto; margin-bottom:-40px; margin-left:0;"
                                         alt="Therapist Signature"/>
                                </div>
                            </t>
                            <t t-else="">
                                <div style="border-top:1px solid #000; width:220px; margin-top:50px;"></div>
                                <p style="font-style:italic; color:#999;">(No signature available)</p>
                            </t>
                            <div style="margin-top:10px; text-align:center; font-size:20px;">
                                <p>স্বাক্ষর (স্পীচ থেরাপিষ্ট)</p>
                            </div>
                        </div>
                    </div>

                    <!-- Page Break for Multiple Records -->
                    <p style="page-break-after:always;"></p>

                </t>
            </main>
        </t>
    </template>
</odoo>
